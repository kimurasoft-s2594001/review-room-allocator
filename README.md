# Review会議室割り当て案作成系统

自动生成Sprint Review会议室分配方案的AI辅助工具。

## 项目简介

本系统根据Jira CSV数据自动分配Sprint Review的会议室，支持：
- **対面Review**（面对面，需要会议室）
- **回覧Review**（传阅，不需要会议室）

## 项目结构

```
review-room-allocator/
├── Review会議室割り当て案作成プロンプト.md  # 主提示词文件（794行）
├── data/                                     # 输入输出文件夹（已gitignore）
│   ├── Jira.csv                             # Jira导出数据
│   ├── *.pdf                                # 之前的Review结果
│   └── SP*.txt                              # 生成的分配方案
├── .claude/
│   └── CLAUDE.md                            # Claude Code 项目配置
└── README.md                                # 本文件
```

## 使用方法

### 1. 准备数据

将以下文件放入 `data/` 文件夹：
- **Jira.csv**: 从Jira导出的Sprint票据数据
- **PDF文件**（可选）: 之前的Review分配结果（用于SPレビュー时排除已Review的票）

### 2. 执行生成

在 Claude Code 中执行：
```
执行提示词
```

或者直接说：
```
生成Review分配
```

### 3. 交互流程

系统会引导你完成以下步骤：

1. **选择操作类型**:
   - 新规作成 (1)
   - 既存案调整 (2)

2. **确定Review类型**:
   - **SP前倒しレビュー**（提前/途中）: 16:00开始，只Review终了日≤Review日的票
   - **SPレビュー**（最终）: 10:00开始，Review全部票但排除前倒し已Review的

3. **提供必要文件**:
   - Jira CSV文件路径
   - （如果是SPレビュー）上次的PDF文件路径

4. **补完PO信息**（如需要）:
   - 系统会列出担当PO为空的票
   - 你需要补充对应的PO名称

5. **生成分配方案**:
   - 输出文件保存到 `data/` 文件夹
   - 文件命名格式：`SPXX[レビュー種別]_MMDD.txt`

## 核心分配逻辑

系统遵循**三级优先顺序**进行会议室分配：

### 【最优先】説明者の制約（Team单位）

- **同一チームのチケット不能在多个房间同时Review**
- 原因：每个Team的説明者（SM/Scrum Master）只有1人
- 如果必须分散到多个房间，确保时间不重叠

**示例**：
```
❌ 错误：
部屋1: T2×2 (0-50分)
部屋2: T2×1 (0-25分)  # T2的説明者无法同时在两个房间

✅ 正确：
部屋1: T2×3 (0-75分)  # T2集中在一个房间
```

### 【第二优先】POの制約（PO单位）

- 同一PO的票尽可能在同一房间（减少PO移动）
- Review必须PO在场才能开始
- PO时间冲突时，通过房间整合或顺序调整解决

**示例**：
```
部屋1（鎌田 → 原田 の順で対応）:
  T2×2 (鎌田)
  T3×1 (鎌田+原田)
部屋2（原田のみ）:
  T5×2 (原田)

→ 原田先在部屋1处理T3，再移动到部屋2处理T5
```

### 【第三优先】Review種別优先级

- 房间内按优先级排序：**主1** > **支援とPOのみ**
- 即使混合多个Team也遵守此顺序

## 输出格式

生成的分配方案包含以下セクション：

### 1. 【回覧Review】
按Team排序（T1→T2→T3→T4→T5），格式：
```
T2,主0 https://docomo-common.atlassian.net/browse/DPCAPP-10282 釘崎,椎野
```
- PO留空表示无担当PO（不显示"該当POなし"）

### 2. 【対面Review - 会議室割り当て】
按房间分组，格式：
```
部屋1（福田のみ）
T1,主1 https://docomo-common.atlassian.net/browse/DPCAPP-10359 福田

部屋2（李 → 鎌田 の順で対応）
T2,主1 https://docomo-common.atlassian.net/browse/DPCAPP-10394 李
T2,支援とPOのみ https://docomo-common.atlassian.net/browse/DPCAPP-8936 鎌田
```

### 3. 【PO移動案内】
**只列出需要移动的PO**：
```
原田: 部屋2 → 部屋3
```

### 4. 【説明者注意】
警告需要2名説明者的Team：
```
⚠️ T1: 部屋1と部屋2で同時進行のため、説明者2名が必要です
```

### 5. 【超時警告】
房间超过120分钟或5票时警告：
```
⚠️ 部屋2: 6票（150分予想）で、推奨時間120分を大幅に超過しています
   現場で調整が必要です
```

### 6. 【注意事項】
标准说明和注意事项

## PO名称映射

系统自动将Jira CSV中的英文PO名转换为日文显示名：

| 英文名 | 日文显示名 |
|--------|-----------|
| kenta kamimoto | 神本 |
| yusuke fukuda | 福田 |
| ryo suzuki | 鈴木良 |
| yoshitaka harada | 原田 |
| ... | ... |

完整映射表见 `Review会議室割り当て案作成プロンプト.md` 文件。

## 常见错误和修正

系统已自动处理以下常见错误：

| 错误 | 正确 |
|------|------|
| 输出"要(対面)"标签 | 应该是"主1" |
| 回覧Review显示"該当POなし" | 留空 |
| PO移動案内列出不移动的PO | 只列移动的 |
| 同一Team分散到多个房间同时Review | 整合到同一房间 |
| 包含非标准PO（如劉宏濤） | 排除（非PO角色） |

## Review类型说明

### SP前倒しレビュー（提前Review/途中レビュー）
- **目的**: SP期间中提前Review终了日早的票
- **对象票**: 终了日 ≤ Review开始日
- **开始时刻**: 固定 **16:00**
- **输出文件**: `SPXX前倒しレビュー_MMDD.txt`

### SPレビュー（最终Review）
- **目的**: SP全体的最终Review
- **对象票**: 对象SP的全部票，**排除前倒し已Review的票**
- **开始时刻**: 固定 **10:00**
- **输出文件**: `SPXXレビュー_MMDD.txt`

## 制约条件

- 1部屋推荐票数: 4〜5票
- 1部屋推荐时间: 120分钟（2小时）
- 每票预想时间: 20〜30分钟（平均25分钟）
- 超过推荐值时会在【超時警告】中提示

## 技术说明

- **提示词文件**: 794行，包含完整逻辑、示例、PO映射表
- **优化历程**: 821行 → 705行（移除交差配置算法） → 794行（完善说明和索引）
- **核心改进**: 明确三级优先顺序，Team优先于PO，避免説明者冲突

## License

本项目仅供内部使用。
